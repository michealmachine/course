# 在线课程平台下一阶段开发需求

## 当前系统状态

目前系统已经实现了以下功能：

1. **用户认证模块**
   - 用户注册（包含邮箱验证）
   - 用户登录
   - 令牌刷新
   - 用户注销

2. **邮箱验证模块**
   - 邮件服务集成
   - 验证码生成和验证
   - Redis存储验证码
   - 邮件模板支持

3. **权限管理模块**
   - 用户管理
   - 角色管理
   - 权限管理
   - 基于RBAC的权限控制

4. **用户自身管理模块**
   - 获取当前用户信息
   - 更新个人资料
   - 修改密码
   - 上传头像（MinIO存储）
   - 更新邮箱（验证码验证）
   - 专用邮箱更新验证码

5. **基础设施**
   - JWT认证
   - Redis缓存
   - H2测试数据库
   - 全局异常处理
   - API文档支持
   - 文件存储服务

6. **系统优化**
   - 文件存储优化：公开资源（如用户头像）使用永久URL而非预签名URL
   - 存储效率优化：头像更新时自动删除旧文件，避免存储空间浪费
   - 架构优化：严格遵循分层架构，确保Controller不直接依赖基础设施服务
   - 文件上传大小限制：配置文件上传最大大小为100MB
   - 异常处理优化：业务逻辑统一在Service层处理并转换为合适的异常

## 下一阶段开发任务

根据项目进度和系统需求，下一阶段的开发任务将集中在课程管理功能上。

### 一、课程管理基础模块（最高优先级）

实现平台的核心业务功能，包括课程的管理、分类和标签等。

#### 1. 课程基础实体设计

**实体类设计**:
- `Course`: 课程基本信息
- `Chapter`: 课程章节
- `Lesson`: 课程小节
- `Resource`: 课程资源（视频、文档等）
- `Category`: 课程分类
- `Tag`: 课程标签
- `CourseTag`: 课程与标签关联

**实现步骤**:
1. 创建上述实体类及其关联关系
2. 设计合理的字段和约束
3. 实现对应的Repository接口

#### 2. 课程分类管理API

**API设计**:
- `GET /api/categories` - 获取分类列表
- `GET /api/categories/{id}` - 获取分类详情
- `POST /api/categories` - 创建分类（管理员）
- `PUT /api/categories/{id}` - 更新分类（管理员）
- `DELETE /api/categories/{id}` - 删除分类（管理员）

**实现步骤**:
1. 创建`CategoryController`及相关DTO/VO类
2. 实现`CategoryService`及其实现类
3. 实现分类的树形结构处理逻辑

#### 3. 课程标签管理API

**API设计**:
- `GET /api/tags` - 获取标签列表
- `GET /api/tags/{id}` - 获取标签详情
- `POST /api/tags` - 创建标签（管理员）
- `PUT /api/tags/{id}` - 更新标签（管理员）
- `DELETE /api/tags/{id}` - 删除标签（管理员）

**实现步骤**:
1. 创建`TagController`及相关DTO/VO类
2. 实现`TagService`及其实现类
3. 实现标签的热门标签推荐逻辑

#### 4. 课程基础管理API

**API设计**:
- `GET /api/courses` - 获取课程列表（支持分页、筛选）
- `GET /api/courses/{id}` - 获取课程详情
- `POST /api/courses` - 创建课程（机构用户和管理员）
- `PUT /api/courses/{id}` - 更新课程（课程创建者和管理员）
- `DELETE /api/courses/{id}` - 删除课程（课程创建者和管理员）
- `GET /api/courses/{id}/chapters` - 获取课程章节
- `POST /api/courses/{id}/chapters` - 创建课程章节

**实现步骤**:
1. 创建`CourseController`及相关DTO/VO类
2. 实现`CourseService`及其实现类
3. 实现课程的搜索和筛选逻辑
4. 实现课程内容管理逻辑

### 二、内容审核功能（次高优先级）

实现课程内容审核功能，确保平台内容质量。

#### 1. 审核流程设计

**功能设计**:
- 课程内容提交审核
- 审核人员审核内容
- 审核结果通知
- 驳回原因反馈

**实现步骤**:
1. 设计审核相关实体类
2. 设计审核流程和状态机
3. 实现审核服务和API接口

#### 2. 审核管理API

**API设计**:
- `POST /api/courses/{id}/submit` - 提交课程审核
- `GET /api/reviews` - 获取待审核列表（审核人员）
- `PUT /api/reviews/{id}` - 更新审核状态（审核人员）
- `GET /api/reviews/history` - 获取审核历史记录

**实现步骤**:
1. 创建`ReviewController`及相关DTO/VO类
2. 实现`ReviewService`及其实现类
3. 实现审核流程和权限控制

## 技术实现要点

1. **安全性考虑**
   - 严格的权限控制，确保只有授权用户能创建和管理课程
   - 文件上传安全验证，防止恶意文件

2. **性能优化**
   - 课程列表和搜索的缓存策略
   - 文件资源的CDN加速策略

3. **权限控制**
   - 基于角色的课程管理权限
   - 基于机构的资源隔离

4. **数据验证**
   - 严格验证课程内容的完整性和合法性
   - 确保资源引用的有效性

## 开发优先级

1. 完成课程基础实体设计（最高优先级）
2. 实现课程分类和标签管理（高优先级）
3. 实现课程基础管理功能（高优先级）
4. 实现课程内容结构管理（中优先级）
5. 实现内容审核流程（中优先级）

通过以上功能的实现，可以搭建起平台的核心课程管理框架，为后续的用户学习、评价、订单等功能提供基础。 